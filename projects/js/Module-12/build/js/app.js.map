{"version":3,"sources":["src/node_modules/browser-pack/_prelude.js","src/src/App.js","src/src/Controller.js","src/src/Form/Form.js","src/src/List/List.js","src/src/Model.js"],"names":[],"mappings":"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","file":"app.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import List from './List/List';\nimport Form from './Form/Form';\nimport Controller from './Controller';\nimport Model from './Model';\n\nwindow.onload = function() {\n  const form = new Form(document.querySelector('#form'));\n  const list = new List(document.querySelector('#list'));\n  const model = new Model();\n  const app = new Controller(model, form, list);\n};\n","export default class {\n  constructor(model, form, list) {\n    this._model = model;\n    this._form = form;\n    this._list = list;\n\n    this._form.setCallback(this._handleFormSubmit.bind(this));\n    this._list.setCallback(this._handleListAction.bind(this));\n    this.fetchBookmarks();\n  }\n\n  _handleFormSubmit(data) {\n    const url = data.get('url');\n    this._model.addBookmark(url)\n      .catch(err => alert(err))\n      .finally(() => this.fetchBookmarks());\n  }\n\n  _handleListAction(action, url) {\n    switch (action) {\n      case 'delete':\n        this._model.removeBookmark(url)\n          .then(() => this.fetchBookmarks());\n        break;\n    }\n  }\n\n  fetchBookmarks() {\n    this._model.listBookmarks()\n      .then(bookmarks => this._list.show(bookmarks))\n      .catch(err => alert('Failed to fetch bookmarks'))\n  }\n}\n","export default class {\n  constructor(container, callback) {\n    this._container = container;\n    this._callback = callback;\n    this.init();\n  }\n\n  init() {\n    this._container.innerHTML = MyApp.templates.Form();\n    const form = this._container.querySelector('form');\n    form.onsubmit = (event) => {\n      event.preventDefault();\n      const data = new FormData(form);\n      if (typeof this._callback === 'function') {\n        this._callback(data);\n      }\n    }\n  }\n\n  setCallback(callback) {\n    if (typeof callback !== 'function') {\n      throw new Error('Callback must be a function!')\n    }\n    this._callback = callback;\n  }\n\n  clean() {\n    const inputs = this._container.querySelectorAll('input:not([type=submit])');\n    inputs.forEach(input => input.value = '');\n  }\n\n  destroy() {\n    this._container.innerHTML = '';\n  }\n}\n","export default class {\n  constructor(container, records, callback) {\n    this._container = container;\n    this._callback = callback;\n    this._container.addEventListener('click', this._handleClick.bind(this));\n    this.show(records);\n  }\n\n  setCallback(callback) {\n    if (typeof callback !== 'function') {\n      throw new Error('Callback must be a function!')\n    }\n    this._callback = callback;\n  }\n\n  show(records) {\n    this._container.innerHTML = MyApp.templates.List({ records })\n  }\n\n  _handleClick(event) {\n    const action = event.target.dataset.action;\n\n    if (!action || typeof this._callback !== 'function') {\n      return false;\n    }\n    event.preventDefault();\n\n    this._callback(action, event.target.dataset.url)\n  }\n\n  destroy() {\n    this._container.removeEventListener('click', this._handleClick);\n    this._container.innerHTML = '';\n  }\n}\n","const regexp = /^(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$/gm;\nconst token = '5d0bc84ec629867245236ce5a981076ce7feffc35c893';\n\nfunction request(method, url, body) {\n  return new Promise((resolve, reject) => {\n    const request = new XMLHttpRequest();\n    request.open(method, url);\n    request.setRequestHeader('Accept', 'application/json');\n    request.setRequestHeader('Content-Type', 'application/json');\n    request.onreadystatechange = () => {\n      if (request.readyState !== 4) {\n        return\n      }\n      const response = JSON.parse(request.response);\n      if (response.error) {\n        reject(response.description)\n      } else {\n        resolve(response);\n      }\n    };\n\n    request.send(JSON.stringify(body));\n  })\n}\n\nexport default class {\n  addBookmark(url) {\n    return new Promise((resolve, reject) => {\n      if (!url) {\n        reject('No url specified!');\n        return false;\n      }\n      if (!url.match(regexp)) {\n        reject('Invalid url');\n        return false;\n      }\n      Promise.all([\n        this.listBookmarks.call(this),\n        request('GET', `https://api.linkpreview.net/?key=${token}&q=${url}`).catch((err) => { console.log(err)})\n      ]).then(([bookmarks, metaInfo]) => {\n        const list = bookmarks || [];\n        const alreadyExists = !!list.find(bookmark => bookmark.url === url);\n        if (alreadyExists) {\n          reject('Already exists');\n          return;\n        }\n        list.unshift({ ...metaInfo, url });\n        localStorage.setItem('bookmarks', JSON.stringify([...list]));\n        resolve([...list]);\n      });\n    })\n  }\n\n  listBookmarks() {\n    return new Promise((resolve, reject) => {\n      const bookmarks = localStorage.getItem('bookmarks');\n      if (bookmarks) {\n        resolve(JSON.parse(bookmarks));\n      }\n\n      resolve(null);\n    })\n  }\n\n  setBookmarks(bookmarks) {\n    return new Promise(resolve => {\n      localStorage.setItem('bookmarks', JSON.stringify(bookmarks));\n      resolve(bookmarks);\n    })\n  }\n\n  removeBookmark(link) {\n    return new Promise((resolve, reject) => {\n      this.listBookmarks().then(bookmarks => {\n        if (bookmarks) {\n          const updated = bookmarks.filter(bookmark => bookmark.url !== link);\n          this.setBookmarks(updated);\n          resolve(updated);\n          return;\n        }\n        reject('No bookmarks found')\n      });\n    });\n  }\n}\n"]}